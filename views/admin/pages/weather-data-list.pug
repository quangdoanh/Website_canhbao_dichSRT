extends ../layouts/default.pug
include ../mixins/optionTinh.pug
include ../mixins/optionHuyen.pug
include ../mixins/optionXa.pug

block main
  h1.box-title Dữ liệu thời tiết

  //- Section 4: Bộ lọc
  .section-4
    .inner-wrap
      .inner-item.inner-label
        <i class="fa-solid fa-filter"></i> Bộ lọc
      .inner-item
        //- label(class="inner-label" for="tinh") Tỉnh
        select(id="tinh" name="tinh" class="tinh" filter-Ma_tinh) 
          option(value="") Tỉnh
          +optionTinh(ListTinh)
      .inner-item
        //- label(class="inner-label" for="huyen") Huyện
        select(id="huyen" name="huyen" class="huyen" filter-Ma_huyen) 
          option(value="") Huyện
          +optionHuyen(ListHuyen)
      .inner-item
        //- label(class="inner-label" for="xa" ) Xã
        select(id="xa" name="xa" class="xa" filter-Ma_xa)
          option(value="") Xã
          +optionXa(ListXaTheoHuyen)
      .inner-item.inner-date
        input(type="date" filter-start-date value="2025-09-01")
        span - 
        input(type="date" filter-end-date value="2025-09-22")
      .inner-item.inner-reset(filter-reset)
        <i class="fa-solid fa-rotate-left"></i> Xóa bộ lọc


  //- Section 6: Bảng danh sách
  .section-6
    .table-2
      table
        thead
          tr
            th.inner-center Tỉnh
            th Huyện
            th Xã
            th Nhiệt độ TB (°C)
            th Lượng mưa TB (mm)
            th Tốc độ gió TB (m/s)
            th Chỉ số k
            th Ngày cập nhật
            th.inner-center Hành động
        tbody
          if dataList && dataList.length
            each item, index in dataList
              tr
                td.inner-center #{item.ten_tinh || 'Không xác định'}
                td #{item.ten_huyen || 'Không xác định'}
                td #{item.ten_xa || 'Không xác định'}
                td #{item.temp_mean}
                td #{item.rain_mean}
                td #{item.wind_mean}
                td #{item.cap_so_p}
                td #{item.ngay_cap_nhat}
                td.inner-center
                  .inner-buttons
                    a.inner-edit(href=`/admin/weather-data/detail/${item.id}`)
                      <i class="fa-solid fa-eye"></i>
                    a.inner-edit(href=`/${pathAdmin}/weather-data/edit/${item.id}`)
                        i(class="fa-regular fa-pen-to-square")
          else 
            tr
              td(colspan="11" style="text-align:center; padding:10px;") Không có dữ liệu

  //- Section 7: Pagination
  .section-7
    - const start = (pagination.page - 1) * limit + 1;
    - const end = Math.min(pagination.page * limit, pagination.totalRecords);
    span.inner-label Hiển thị #{start} - #{end} của #{pagination.totalRecords}

    select.inner-pagination(pagination name="page")
      each val in [...Array(pagination.totalPages).keys()]
        - const pageNum = val + 1;
        option(value=pageNum selected=(pageNum === pagination.page)) Trang #{pageNum}
