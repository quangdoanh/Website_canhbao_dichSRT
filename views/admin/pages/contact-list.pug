extends ../layouts/default

block main
  h1.box-title Danh sách liên hệ

  //- Section 4: Bộ lọc
  //- .section-4
  //-   .inner-wrap
  //-     .inner-item.inner-label
  //-       <i class="fa-solid fa-filter"></i> Bộ lọc
  //-     .inner-item
  //-       select(filter-status)
  //-         option(value="") Trạng thái
  //-         option(value="0") Chưa xử lý
  //-         option(value="1") Đã trả lời
  //-         option(value="2") Đang xử lý
  //-     .inner-item.inner-date
  //-       input(type="date" filter-start-date)
  //-       span - 
  //-       input(type="date" filter-end-date)
  //-     .inner-item.inner-reset(filter-reset)
  //-       <i class="fa-solid fa-rotate-left"></i> Xóa bộ lọc

  //- Section 5: Hành động & tìm kiếm
  .section-5
    .inner-wrap
      .inner-change-status(
        change-multi 
        data-api =`/${pathAdmin}/contact/change-multi`
      )
        .inner-item
          select()
            option(value="") -- Hành động --
            option(value="true") Hiện
            option(value="false") Ẩn
        .inner-item
          button Áp dụng


  //- Section 6: Bảng danh sách
  .section-6
    .table-2
      table
        thead
          tr
            th.inner-center
              input(type="checkbox" class="inner-check" check-all)
            th Họ tên
            th Email
            th Số điện thoại
            th.inner-center Chủ đề
            th.inner-center Trạng thái
            th.inner-center Hiển thị
            th Ngày tạo
            th Hành động
        tbody
          if contactList && contactList.length > 0
            each contact in contactList
              tr
                td.inner-center
                  input(type="checkbox" class="inner-check" check-item = contact.id)
                td= contact.full_name
                td= contact.email
                td= contact.phone || "-"
                td.inner-center
                  if contact.topic == "sau-rom-thong"
                    | Sâu róm Thông
                  else if contact.topic == "sau-hai-lakeo"
                    | Sâu hại lá Keo
                  else if contact.topic == "benh-hai-lakeo"
                    | Bệnh hại lá Keo
                  else
                    | #{contactDetail.topic||"Không xác định"}
                td.inner-center
                  if contact.status == 1
                    .badge.badge-green Đã trả lời
                  else
                    .badge.badge-red Chưa xử lý
                td.inner-center
                  label.switch
                    input(
                      type="checkbox"
                      checked=(contact.is_public ? true : false)
                      toggle-public
                      data-id=contact.id
                      data-api=`/${pathAdmin}/contact/change-public/${contact.id}`
                    )
                    span.slider.round
                td= contact.createdAtFormat
                td
                  .inner-buttons
                      a.inner-edit(href=`/${pathAdmin}/contact/answer/${contact.id}`)
                        i.fa-regular.fa-eye
          else
            tr
              td(colspan="9" class="inner-center") Không có dữ liệu
  //- Section 7: Pagination
  .section-7
    - const start = (pagination.page - 1) * limit + 1;
    - const end = Math.min(pagination.page * limit, pagination.totalRecords);
    span.inner-label Hiển thị #{start} - #{end} của #{pagination.totalRecords}

    select.inner-pagination(pagination name="page")
      each val in [...Array(pagination.totalPages).keys()]
        - const pageNum = val + 1;
        option(value=pageNum selected=(pageNum === pagination.page)) Trang #{pageNum}
